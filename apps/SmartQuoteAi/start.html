$Content = @'
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LionGateOS — Enhanced Visual Dashboard</title>
  <style>
    :root {
      --lg-bg0: #060814;
      --lg-bg1: #0b1024;
      --lg-surface: rgba(255,255,255,.06);
      --lg-surface2: rgba(255,255,255,.04);
      --lg-stroke: rgba(255,255,255,.12);
      --lg-stroke2: rgba(255,255,255,.14);
      --lg-text: rgba(255,255,255,.92);
      --lg-muted: rgba(255,255,255,.68);
      --lg-muted2: rgba(255,255,255,.45);
      --lg-accent: #3b82f6;
      --lg-accent2: #6366f1;
      --lg-accent3: #ec4899; /* Third Color */
      --lg-glow: 1;
      --lg-frame-radius: 22px;
      --lg-frame-glow-color: var(--lg-accent);
      --lg-frame-glow-intensity: 0;
      --shadow: 0 24px 70px rgba(0,0,0,.55);
      --good: #35d39a;
      --warn: #f59e0b;
      --bad: #f87171;
      --lg-splash-dim: 0.35;
      --lg-splash-blur: 0px;
    }
    [data-theme="dark"]{--lg-bg0:#060814;--lg-bg1:#0b1024;--lg-surface:rgba(255,255,255,.06);--lg-stroke:rgba(255,255,255,.12);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#3b82f6;--lg-accent2:#6366f1;--lg-accent3:#ec4899}
    [data-theme="light"]{--lg-bg0:#f7fafc;--lg-bg1:#e9eef7;--lg-surface:rgba(0,0,0,.06);--lg-stroke:rgba(0,0,0,.14);--lg-text:rgba(0,0,0,.92);--lg-muted:rgba(0,0,0,.66);--lg-accent:#2563eb;--lg-accent2:#7c3aed;--lg-accent3:#06b6d4}
    [data-theme="midnight"]{--lg-bg0:#0a0e1a;--lg-bg1:#111827;--lg-surface:rgba(99,102,241,.08);--lg-stroke:rgba(99,102,241,.25);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#60a5fa;--lg-accent2:#818cf8;--lg-accent3:#c084fc}
    [data-theme="slate"]{--lg-bg0:#0f172a;--lg-bg1:#1e293b;--lg-surface:rgba(148,163,184,.08);--lg-stroke:rgba(148,163,184,.2);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#38bdf8;--lg-accent2:#a78bfa;--lg-accent3:#2dd4bf}
    [data-theme="ember"]{--lg-bg0:#1a0f0a;--lg-bg1:#2d1810;--lg-surface:rgba(249,115,22,.08);--lg-stroke:rgba(249,115,22,.25);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#f97316;--lg-accent2:#ef4444;--lg-accent3:#fbbf24}
    [data-theme="cyberpunk"]{--lg-bg0:#0d0221;--lg-bg1:#1a0533;--lg-surface:rgba(236,72,153,.1);--lg-stroke:rgba(236,72,153,.3);--lg-text:#f0abfc;--lg-muted:rgba(240,171,252,.7);--lg-accent:#ec4899;--lg-accent2:#06b6d4;--lg-accent3:#facc15}
    [data-theme="ocean"]{--lg-bg0:#042f49;--lg-bg1:#083344;--lg-surface:rgba(34,211,238,.08);--lg-stroke:rgba(34,211,238,.25);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#22d3ee;--lg-accent2:#2dd4bf;--lg-accent3:#38bdf8}
    [data-theme="forest"]{--lg-bg0:#052e16;--lg-bg1:#14532d;--lg-surface:rgba(34,197,94,.1);--lg-stroke:rgba(34,197,94,.25);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#22c55e;--lg-accent2:#84cc16;--lg-accent3:#10b981}
    [data-theme="sunset"]{--lg-bg0:#1c1917;--lg-bg1:#292524;--lg-surface:rgba(251,146,60,.08);--lg-stroke:rgba(251,146,60,.25);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#fb923c;--lg-accent2:#f43f5e;--lg-accent3:#fbbf24}
    [data-theme="aurora"]{--lg-bg0:#0c1222;--lg-bg1:#0f172a;--lg-surface:rgba(167,139,250,.1);--lg-stroke:rgba(167,139,250,.25);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#a78bfa;--lg-accent2:#34d399;--lg-accent3:#f472b6}
    [data-theme="neon-city"]{--lg-bg0:#0a0a0a;--lg-bg1:#171717;--lg-surface:rgba(250,204,21,.08);--lg-stroke:rgba(250,204,21,.3);--lg-text:#fef08a;--lg-muted:rgba(254,240,138,.7);--lg-accent:#facc15;--lg-accent2:#f472b6;--lg-accent3:#22d3ee}
    [data-theme="royal"]{--lg-bg0:#1e1b4b;--lg-bg1:#312e81;--lg-surface:rgba(199,210,254,.1);--lg-stroke:rgba(199,210,254,.25);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#c7d2fe;--lg-accent2:#fbbf24;--lg-accent3:#e879f9}
    [data-theme="matrix"]{--lg-bg0:#000;--lg-bg1:#0a0f0a;--lg-surface:rgba(0,255,65,.06);--lg-stroke:rgba(0,255,65,.25);--lg-text:#00ff41;--lg-muted:rgba(0,255,65,.7);--lg-accent:#00ff41;--lg-accent2:#39ff14;--lg-accent3:#008f11}
    [data-theme="cherry"]{--lg-bg0:#1a0a14;--lg-bg1:#2d1020;--lg-surface:rgba(244,114,182,.08);--lg-stroke:rgba(244,114,182,.25);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#f472b6;--lg-accent2:#fb7185;--lg-accent3:#e11d48}
    [data-theme="ice"]{--lg-bg0:#0c1929;--lg-bg1:#172554;--lg-surface:rgba(186,230,253,.08);--lg-stroke:rgba(186,230,253,.2);--lg-text:rgba(255,255,255,.92);--lg-muted:rgba(255,255,255,.68);--lg-accent:#7dd3fc;--lg-accent2:#bae6fd;--lg-accent3:#e0f2fe}
    
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{width:100%;height:100%;overflow:hidden;background:var(--lg-bg0)}
    body{font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--lg-text);position:relative}
    #lg-background-layer{position:fixed;inset:0;z-index:-1;background:var(--lg-bg0);transition:opacity .3s}
    #lg-background-layer.custom-active{background-image:var(--lg-bg-custom);background-size:cover;background-position:center}
    #lg-background-layer video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
    #lg-bg-error{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:rgba(220,38,38,.9);color:#fff;padding:12px 20px;border-radius:12px;font-size:13px;font-weight:600;z-index:999;display:none;max-width:90%;text-align:center}
    #lg-bg-error.visible{display:block}
    #lg-screensaver{position:fixed;inset:0;z-index:9998;background:#000;display:none;opacity:0;transition:opacity .5s;cursor:none}
    #lg-screensaver.active{display:flex;align-items:center;justify-content:center;opacity:1}
    #lg-screensaver video,#lg-screensaver img{width:100%;height:100%;object-fit:cover}
    #lg-screensaver canvas{position:absolute;inset:0;width:100%!important;height:100%!important}
    #lg-screensaver .ss-clock{font-size:96px;font-weight:800;color:#fff;text-shadow:0 0 40px var(--lg-accent)}
    #lg-screensaver .ss-dismiss-hint{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);color:rgba(255,255,255,.5);font-size:12px;letter-spacing:.1em;text-transform:uppercase}
    #lg-visuals{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
    #lg-visuals canvas{position:absolute;inset:0;width:100%;height:100%;display:block}
    #lg-particles{opacity:.6;display:none}
    #lg-particles.active{display:block}
    #lg-tracers{mix-blend-mode:screen;opacity:.8;display:none}
    #lg-tracers.active{display:block}
    .shell{position:relative;z-index:1;display:flex;flex-direction:column;width:100%;height:100%;min-height:0;overflow:hidden;padding:14px;gap:12px}
    .top{flex:0 0 auto;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:16px 18px;border:1px solid var(--lg-stroke);border-radius:var(--lg-frame-radius);background:linear-gradient(180deg,var(--lg-surface),var(--lg-surface2));backdrop-filter:blur(10px);box-shadow:var(--shadow)}
    .brand h1{margin:0;font-size:28px;letter-spacing:.2px;font-weight:800;color:var(--lg-text)}
    .brand .sub{margin-top:4px;color:var(--lg-muted);font-size:12px;letter-spacing:.08em;text-transform:uppercase}
    #brandLogo{width:36px;height:36px;object-fit:contain;margin-right:10px;vertical-align:-8px;filter:drop-shadow(0 2px 6px rgba(0,0,0,.45))}
    .actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .pill{height:38px;padding:0 14px;border-radius:999px;border:1px solid var(--lg-stroke);background:var(--lg-surface);color:var(--lg-text);font-weight:800;cursor:pointer;user-select:none;transition:background .15s,border-color .15s}
    .pill:hover{background:var(--lg-surface2);border-color:var(--lg-accent)}
    .pill.primary{background:rgba(59,130,246,.22);border-color:var(--lg-accent)}
    .pill.ghost{background:var(--lg-surface2);color:var(--lg-muted)}
    .tabs{flex:0 0 auto;display:flex;gap:8px;padding:0 4px;overflow-x:auto;scrollbar-width:none}
    .tabs::-webkit-scrollbar{display:none}
    .tab{flex:0 0 auto;height:42px;padding:0 18px;border-radius:12px;border:1px solid transparent;background:transparent;color:var(--lg-muted);font-weight:700;font-size:14px;cursor:pointer;user-select:none;transition:all .15s}
    .tab:hover{background:var(--lg-surface);color:var(--lg-text)}
    .tab.active{background:var(--lg-surface);border-color:var(--lg-accent2);color:var(--lg-text);border-bottom:2px solid var(--lg-accent2)}
    .content{flex:1 1 0%;min-height:0;overflow:visible;position:relative;display:flex;flex-direction:column}
    .panel{width:100%;height:100%;min-height:0;flex:1 1 0%;display:none;flex-direction:column;border:1px solid var(--lg-stroke);border-radius:var(--lg-frame-radius);background:linear-gradient(180deg,var(--lg-surface),var(--lg-surface2));backdrop-filter:blur(10px);box-shadow:var(--shadow);overflow:hidden}
    .panel:not(.hidden){display:flex}
    .panel[data-frame-style="glass"]{background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.02));border:1px solid var(--lg-stroke);backdrop-filter:blur(20px) saturate(1.8)}
    .panel[data-frame-style="neon"]{background:linear-gradient(180deg,rgba(0,0,0,.6),rgba(0,0,0,.8))!important;border:2px solid var(--lg-accent)!important;box-shadow:none!important;backdrop-filter:none!important;-webkit-backdrop-filter:none!important;overflow:visible !important;-webkit-mask-image:none !important;filter:drop-shadow(0 0 calc(15px + var(--lg-frame-glow-intensity) * 1px) var(--lg-frame-glow-color)) !important}
    .top[data-frame-style="neon"]{background:linear-gradient(180deg,rgba(0,0,0,.6),rgba(0,0,0,.8))!important;border:2px solid var(--lg-accent)!important;box-shadow:none!important;backdrop-filter:none!important;-webkit-backdrop-filter:none!important;overflow:visible !important;-webkit-mask-image:none !important;filter:drop-shadow(0 0 calc(15px + var(--lg-frame-glow-intensity) * 1px) var(--lg-frame-glow-color)) !important}
    .head{flex:0 0 auto;padding:18px 20px 14px;border-bottom:1px solid var(--lg-stroke);background:linear-gradient(180deg,var(--lg-surface),transparent)}
    .panel[data-frame-style="neon"] .head{background:transparent;border-bottom-color:var(--lg-accent);border-top-left-radius:calc(var(--lg-frame-radius) - 2px);border-top-right-radius:calc(var(--lg-frame-radius) - 2px)}
    .title{font-size:24px;font-weight:800;letter-spacing:.2px;color:var(--lg-text)}
    .meta{margin-top:6px;color:var(--lg-text);font-size:13px;line-height:1.4}
    .body{flex:1 1 0%;min-height:0;overflow:auto;padding:18px 20px;display:flex;flex-direction:column;color:var(--lg-text)}
    .module-container{flex:1 1 0%;min-height:0;display:flex;flex-direction:column;position:relative;width:100%;height:100%}
    .module-frame{flex:1 1 0%;width:100%;min-height:0;border:none;background:transparent;display:block}
    
    /* Firefox Fix */
    @-moz-document url-prefix() {
      .shell, .content, .panel, .body, .module-container {
        height: 100% !important;
        min-height: 0 !important;
      }
    }

    .module-error{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:var(--lg-muted);text-align:center;gap:12px}
    .module-error .error-icon{font-size:48px;opacity:.5}
    .module-error .error-path{font-family:monospace;font-size:12px;background:var(--lg-surface);padding:8px 16px;border-radius:8px;color:var(--lg-accent)}
    
    /* SPLASH OVERLAY STYLES */
    .splashOverlay{position:fixed;inset:0;z-index:9999;background:#05060b;display:flex;align-items:center;justify-content:center;opacity:1;transition:opacity .4s;cursor:pointer}
    .splashOverlay.hidden{opacity:0;pointer-events:none}
    
    .auth-modal{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,.7);backdrop-filter:blur(8px);display:none;align-items:center;justify-content:center}
    .auth-modal.open{display:flex}
    .auth-box{width:min(420px,calc(100% - 40px));background:linear-gradient(180deg,var(--lg-bg1),var(--lg-bg0));border:1px solid var(--lg-stroke);border-radius:var(--lg-frame-radius);padding:32px;box-shadow:0 24px 80px rgba(0,0,0,.6)}
    .auth-box h2{font-size:22px;font-weight:800;margin-bottom:8px;color:var(--lg-text)}
    .auth-box p{color:var(--lg-muted);font-size:14px;margin-bottom:24px}
    .auth-box input{width:100%;height:44px;border-radius:12px;border:1px solid var(--lg-stroke);background:var(--lg-surface);color:var(--lg-text);padding:0 16px;font-size:14px;margin-bottom:12px}
    .auth-box input:focus{outline:none;border-color:var(--lg-accent)}
    .auth-box .auth-actions{display:flex;gap:12px;margin-top:20px}
    .auth-box .auth-actions button{flex:1;height:44px;border-radius:12px;border:1px solid var(--lg-stroke);font-weight:700;cursor:pointer;transition:all .15s}
    .auth-box .auth-btn-primary{background:var(--lg-accent);color:#fff;border-color:var(--lg-accent)}
    .auth-box .auth-btn-secondary{background:var(--lg-surface);color:var(--lg-text)}
    .auth-tabs{display:flex;gap:8px;margin-bottom:20px}
    .auth-tab{flex:1;height:36px;border:none;background:transparent;color:var(--lg-muted);font-weight:700;cursor:pointer;border-bottom:2px solid transparent}
    .auth-tab.active{color:var(--lg-accent);border-bottom-color:var(--lg-accent)}
    
    /* --- DRAGGABLE ORB CONTAINER --- */
    .ai-container {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%); 
        width: 300px; /* Default Base Size */
        height: 300px;
        z-index: 9999;
        display: none;
        opacity: 0;
        transition: opacity 0.4s ease;
        background: transparent !important;
        cursor: grab;
    }
    
    .ai-container.visible {
        display: block;
        opacity: 1;
    }
    
    .ai-container:active {
        cursor: grabbing; 
    }
    
    #aiOrbCanvas {
      width: 100%;
      height: 100%;
      display: block;
      pointer-events: none; 
    }
    
    .drawerBackdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);z-index:100;opacity:0;pointer-events:none;transition:opacity .25s}
    .drawerBackdrop.open{opacity:1;pointer-events:all}
    .drawer{position:fixed;top:14px;right:14px;bottom:14px;width:min(520px,calc(100% - 28px));border-radius:var(--lg-frame-radius);border:1px solid var(--lg-stroke);background:linear-gradient(180deg,var(--lg-bg1),var(--lg-bg0));backdrop-filter:blur(20px);box-shadow:0 24px 90px rgba(0,0,0,.65);z-index:101;transform:translateX(calc(100% + 28px));transition:transform .3s cubic-bezier(.4,0,.2,1);display:flex;flex-direction:column;overflow:visible}
    .drawer.open{transform:translateX(0)}
    .drawerHeader{flex:0 0 auto;padding:18px 20px 14px;border-bottom:1px solid var(--lg-stroke);display:flex;justify-content:space-between;align-items:center;gap:12px}
    .drawerHeader h2{margin:0;font-size:16px;letter-spacing:.12em;text-transform:uppercase;color:var(--lg-muted);font-weight:800}
    .drawerBody{flex:1 1 auto;min-height:0;overflow-y:auto;overflow-x:hidden;padding:16px 20px 20px}
    .drawerBody::-webkit-scrollbar{width:8px}
    .drawerBody::-webkit-scrollbar-track{background:transparent}
    .drawerBody::-webkit-scrollbar-thumb{background:rgba(59,130,246,.4);border-radius:999px}
    .group{border:1px solid var(--lg-stroke);border-radius:16px;background:var(--lg-surface);padding:14px;margin-bottom:14px}
    .groupTitle{margin:0 0 12px;font-size:12px;letter-spacing:.08em;text-transform:uppercase;color:var(--lg-accent);font-weight:800}
    .drawer label{display:flex;justify-content:space-between;align-items:center;gap:12px;font-size:13px;color:var(--lg-text);margin:10px 0;font-weight:600}
    .drawer input[type="range"]{width:54%;accent-color:var(--lg-accent)}
    .drawer input[type="number"]{width:80px;height:32px;border-radius:8px;border:1px solid var(--lg-stroke);background:var(--lg-surface2);color:var(--lg-text);padding:0 10px;font-size:13px;text-align:center}
    .drawer input[type="color"]{width:48px;height:32px;padding:0;border:1px solid var(--lg-stroke);background:transparent;border-radius:8px;cursor:pointer}
    .drawer input[type="text"],.drawer input[type="url"]{width:100%;height:38px;border-radius:10px;border:1px solid var(--lg-stroke);background:var(--lg-surface2);color:var(--lg-text);padding:0 12px;font-size:13px}
    .drawer input[type="text"]:focus,.drawer input[type="url"]:focus{outline:none;border-color:var(--lg-accent);box-shadow:0 0 0 3px rgba(59,130,246,.2)}
    .drawer select{width:54%;height:38px;border-radius:10px;border:1px solid var(--lg-stroke);background:var(--lg-surface2);color:var(--lg-text);padding:0 12px;font-weight:600;cursor:pointer}
    .drawer select option{background:var(--lg-bg1);color:var(--lg-text);padding:4px 8px}
    .drawer .btn{width:100%;height:40px;border-radius:12px;border:1px solid var(--lg-stroke);background:rgba(59,130,246,.18);color:var(--lg-text);font-weight:800;cursor:pointer;transition:background .15s;margin-top:8px}
    .drawer .btn:hover{background:rgba(59,130,246,.25)}
    .drawer .btn.secondary{background:var(--lg-surface2)}
    .drawer .btn.success{background:rgba(34,197,94,.2);border-color:rgba(34,197,94,.4)}
    .mini{font-size:11px;color:var(--lg-muted2);line-height:1.4;margin:8px 0 0}
    .toggle-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0}
    .toggle-switch{position:relative;width:48px;height:26px;background:var(--lg-surface2);border-radius:999px;cursor:pointer;transition:background .2s;border:1px solid var(--lg-stroke)}
    .toggle-switch.active{background:var(--lg-accent)}
    .toggle-switch::after{content:'';position:absolute;top:3px;left:3px;width:18px;height:18px;background:#fff;border-radius:50%;transition:transform .2s}
    .toggle-switch.active::after{transform:translateX(22px)}
    .preview-box{width:100%;height:100px;border-radius:12px;border:1px solid var(--lg-stroke);background:var(--lg-surface2);margin:10px 0;display:flex;align-items:center;justify-content:center;color:var(--lg-muted);font-size:12px;overflow:hidden;position:relative}
    .preview-box img,.preview-box video{width:100%;height:100%;object-fit:cover}
    .splashOverlay{position:fixed;inset:0;z-index:9999;background:#05060b;display:flex;align-items:center;justify-content:center;opacity:1;transition:opacity .4s;cursor:pointer}
    .splashOverlay.hidden{opacity:0;pointer-events:none}
    .splashVideo{width:100%;height:100%;object-fit:contain;pointer-events:none;filter:brightness(calc(1 - var(--lg-splash-dim))) blur(var(--lg-splash-blur))}
    .splashHint{position:absolute;bottom:22px;left:50%;transform:translateX(-50%);font-size:12px;letter-spacing:.08em;text-transform:uppercase;opacity:.55;color:var(--lg-muted);pointer-events:none}
    .apps-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}
    .app-card{border:1px solid var(--lg-stroke);border-radius:16px;background:var(--lg-surface);padding:20px;cursor:pointer;transition:all .2s}
    .app-card:hover{background:var(--lg-surface2);border-color:var(--lg-accent);box-shadow:0 0 20px rgba(59,130,246,.2)}
    .app-card h3{font-size:16px;font-weight:700;margin-bottom:6px;color:var(--lg-text)}
    .app-card p{font-size:13px;color:var(--lg-muted);line-height:1.4}
    .app-card .status{margin-top:12px;font-size:11px;text-transform:uppercase;letter-spacing:.05em;color:var(--good)}
    @media(prefers-reduced-motion:reduce){*{transition:none!important;animation:none!important}}
    @media(max-width:900px){.brand h1{font-size:22px}#brandLogo{width:32px;height:32px}.drawer{width:calc(100% - 28px)}}
    @media(max-width:640px){.shell{padding:10px;gap:10px}.top{padding:12px 14px}.brand h1{font-size:18px}.tabs{gap:6px}.tab{padding:0 14px;font-size:13px}.ai-container{bottom:16px;right:16px}.ai-orb{width:72px;height:72px}}
    .hidden{display:none!important}
  </style>
</head>
<body>
  <div id="lg-background-layer"></div>
  <div id="lg-bg-error"></div>
  <div id="lg-screensaver" aria-hidden="true"></div>
  <div id="lg-visuals" aria-hidden="true"><canvas id="lg-particles"></canvas><canvas id="lg-tracers"></canvas></div>
  <div id="splashOverlay" class="splashOverlay" aria-hidden="true"><video id="splashVideo" class="splashVideo" autoplay muted playsinline preload="auto"><source src="assets/splash.mp4" type="video/mp4"/></video><div class="splashHint">Click anywhere or press ESC to continue</div></div>
  <div class="auth-modal" id="authModal"><div class="auth-box"><h2 id="authTitle">Welcome</h2><p id="authSubtitle">Sign in to access your workspace</p><div class="auth-tabs"><button class="auth-tab active" data-auth="signin">Sign In</button><button class="auth-tab" data-auth="signup">Sign Up</button></div><input type="email" id="authEmail" placeholder="Email address"/><input type="password" id="authPassword" placeholder="Password"/><div id="authSignupFields" style="display:none;"><input type="password" id="authConfirm" placeholder="Confirm password"/></div><div class="auth-actions"><button class="auth-btn-secondary" id="authCancel">Cancel</button><button class="auth-btn-primary" id="authSubmit">Continue</button></div></div></div>
  
  <div class="ai-container" id="aiContainer">
    <canvas id="aiOrbCanvas"></canvas>
  </div>

  <div class="shell">
    <header class="top" data-frame-style="default"><div class="brand"><h1><img id="brandLogo" src="assets/LionGateOS_logo.png" alt="" onerror="this.style.display='none'"/>LionGateOS</h1><div class="sub">Enhanced Visual Dashboard · Local-Only · 2026</div></div><div class="actions"><button class="pill ghost" id="btnAppearance" type="button">Appearance</button><button class="pill ghost" id="btnSignIn" type="button">Sign In</button><button class="pill" id="btnExport" type="button">Export</button><button class="pill primary" id="btnReset" type="button">Reset</button></div></header>
    <nav class="tabs"><button class="tab active" data-tab="overview" type="button">Overview</button><button class="tab" data-tab="calendar" type="button">Calendar</button><button class="tab" data-tab="apps" type="button">Apps</button><button class="tab" data-tab="governance" type="button">Notes</button></nav>
    <main class="content">
      <section class="panel" id="tab-overview" data-frame-style="default"><div class="head"><div class="title">Overview</div><div class="meta">System dashboard and module status</div></div><div class="body"><p>LionGateOS Enhanced - Canonical layout with advanced visual system.</p><div style="margin-top:24px;padding:16px;border:1px solid var(--lg-stroke);border-radius:12px;background:var(--lg-surface);"><h3 style="font-size:14px;margin-bottom:12px;color:var(--lg-accent);">Quick Status</h3><p style="font-size:13px;color:var(--lg-muted);line-height:1.6;"><strong>Particles:</strong> <span id="statusParticles">Off</span><br/><strong>Tracers:</strong> <span id="statusTracers">Off</span><br/><strong>Screensaver:</strong> <span id="statusScreensaver">Disabled</span><br/><strong>Theme:</strong> <span id="statusTheme">Dark</span></p></div></div></section>
      <section class="panel hidden" id="tab-calendar" data-frame-style="default"><div class="head"><div class="title">Calendar</div><div class="meta">Schedule and events</div></div><div class="body" style="padding:0;"><div class="module-container" id="calendarContainer"></div></div></section>
      <section class="panel hidden" id="tab-apps" data-frame-style="default"><div class="head"><div class="title">Apps</div><div class="meta">Module launcher</div></div><div class="body"><div class="apps-grid" id="appsGrid"></div></div></section>
      <section class="panel hidden" id="tab-governance" data-frame-style="default"><div class="head"><div class="title">Governance Notes</div><div class="meta">System documentation</div></div><div class="body"><p>Documentation placeholder.</p></div></section>
    </main>
  </div>
  <div class="drawerBackdrop" id="drawerBackdrop"></div>
  <aside class="drawer" id="drawer">
    <div class="drawerHeader"><h2>Appearance</h2><button class="pill ghost" id="closeDrawerBtn" type="button">Close</button></div>
    <div class="drawerBody">
      <div class="group"><div class="groupTitle">Themes</div><label><span>Preset</span><select id="themePreset"><option value="dark">Dark</option><option value="light">Light</option><option value="midnight">Midnight</option><option value="slate">Slate</option><option value="ember">Ember</option><option value="cyberpunk">Cyberpunk</option><option value="ocean">Ocean</option><option value="forest">Forest</option><option value="sunset">Sunset</option><option value="aurora">Aurora</option><option value="neon-city">Neon City</option><option value="royal">Royal</option><option value="matrix">Matrix</option><option value="cherry">Cherry</option><option value="ice">Ice</option></select></label><label><span>Accent</span><input type="color" id="accentColor" value="#3b82f6"/></label><label><span>Accent 2</span><input type="color" id="accent2Color" value="#6366f1"/></label><label><span>Accent 3</span><input type="color" id="accent3Color" value="#ec4899"/></label><label><span>BG Base</span><input type="color" id="bgBaseColor" value="#060814"/></label><label><span>Surface</span><input type="color" id="surfaceColor" value="#0b1024"/></label><label><span>Text</span><input type="color" id="textColor" value="#ffffff"/></label><label><span>Muted</span><input type="color" id="mutedColor" value="#aaaaaa"/></label><label><span>Stroke</span><input type="color" id="strokeColor" value="#333333"/></label><label><span>Glow</span><input type="range" id="glowStrength" min="0" max="200" value="100"/></label></div>
      <div class="group"><div class="groupTitle">Panel Frames</div><label><span>Style</span><select id="frameStyle"><option value="default">Default</option><option value="glass">Glass</option><option value="neon">Neon</option></select></label><label><span>Radius</span><input type="range" id="frameRadius" min="0" max="40" value="22"/></label><label><span>Glow Color</span><input type="color" id="frameGlowColor" value="#3b82f6"/></label><label><span>Glow Intensity</span><input type="range" id="frameGlowIntensity" min="0" max="60" value="0"/></label></div>
      <div class="group"><div class="groupTitle">Background</div><label><span>Type</span><select id="bgType"><option value="default">Default</option><option value="url">Image URL</option><option value="upload">Upload</option><option value="video">Video URL</option></select></label><div id="bgUrlInput" style="display:none;margin-top:10px;"><input type="url" id="bgUrl" placeholder="Image URL"/><button class="btn" id="applyBgUrl">Apply</button></div><div id="bgUploadInput" style="display:none;margin-top:10px;"><input type="file" id="bgFile" accept="image/*" style="width:100%;"/></div><div id="bgVideoInput" style="display:none;margin-top:10px;"><input type="url" id="bgVideoUrl" placeholder="Video URL"/><button class="btn" id="applyBgVideo">Apply</button></div><label><span>Opacity</span><input type="range" id="bgOpacity" min="0" max="100" value="100"/></label><div id="bgPreview" class="preview-box"><span>Preview</span></div><button class="btn secondary" id="resetBg">Reset</button></div>
      <div class="group"><div class="groupTitle">Particles</div><div class="toggle-row"><span>Enabled</span><div class="toggle-switch" id="particlesToggle"></div></div><label><span>Count</span><input type="range" id="particleCount" min="20" max="300" value="120"/></label><label><span>Speed</span><input type="range" id="particleSpeed" min="1" max="100" value="35"/></label><label><span>Distance</span><input type="range" id="particleDistance" min="50" max="250" value="120"/></label><label><span>Brightness</span><input type="range" id="particleBrightness" min="10" max="100" value="60"/></label><label><span>Size Var</span><input type="range" id="particleSizeVar" min="1" max="10" value="3"/></label><label><span>Color Mode</span><select id="particleColorMode"><option value="single">Single</option><option value="rainbow">Rainbow</option><option value="gradient">Gradient</option></select></label><label id="particleColorLabel"><span>Color</span><input type="color" id="particleColor" value="#3b82f6"/></label></div>
      <div class="group"><div class="groupTitle">Tracers</div><div class="toggle-row"><span>Enabled</span><div class="toggle-switch" id="tracersToggle"></div></div><label><span>Count</span><input type="range" id="tracerCount" min="1" max="6" value="1"/></label><label><span>Color</span><input type="color" id="tracerColor" value="#3b82f6"/></label><label><span>Speed</span><input type="range" id="tracerSpeed" min="1" max="100" value="50"/></label><label><span>Speed Var</span><input type="range" id="tracerSpeedVar" min="0" max="50" value="10"/></label><label><span>Thickness</span><input type="range" id="tracerThickness" min="1" max="20" value="4"/></label><label><span>Glow</span><input type="range" id="tracerGlow" min="0" max="100" value="60"/></label><label><span>Glow Var</span><input type="range" id="tracerGlowVar" min="0" max="30" value="10"/></label><label><span>Trail</span><input type="range" id="tracerTrail" min="10" max="200" value="80"/></label><label><span>Direction</span><select id="tracerDirection"><option value="clockwise">CW</option><option value="counter">CCW</option><option value="random">Random</option></select></label><label><span>Target</span><select id="tracerTarget"><option value="perimeter">Perimeter</option><option value="panels">Panels</option></select></label></div>
      <div class="group"><div class="groupTitle">Screensaver</div><div class="toggle-row"><span>Enabled</span><div class="toggle-switch" id="screensaverToggle"></div></div><label><span>Idle (min)</span><input type="number" id="screensaverTime" min="1" max="60" value="5"/></label><label><span>Type</span><select id="screensaverType"><option value="particles">Particles</option><option value="clock">Clock</option><option value="video">Video</option><option value="image">Image</option></select></label><div id="screensaverMediaInput" style="display:none;margin-top:10px;"><input type="url" id="screensaverUrl" placeholder="Media URL"/><button class="btn" id="applyScreensaverUrl">Set</button></div><button class="btn success" id="testScreensaver">Test</button><button class="btn secondary" id="stopScreensaver" style="display:none;">Stop</button></div>
      <div class="group"><div class="groupTitle">Modules</div><label><span>Calendar</span><input type="text" id="pathCalendar" value="apps/Calendar/index.html"/></label><label><span>Budget</span><input type="text" id="pathBudget" value="apps/Budget/index.html"/></label><label><span>Travels</span><input type="text" id="pathTravels" value="apps/LionGateTravels/index.html"/></label><label><span>Rows</span><input type="text" id="pathRows" value="apps/Rows/index.html"/></label><label><span>SmartQuote</span><input type="text" id="pathSmartQuote" value="apps/SmartQuoteAi/index.html"/></label><button class="btn" id="reloadModules">Reload</button></div>
      <div class="group"><div class="groupTitle">Splash</div><label><span>Show</span><select id="splashToggle"><option value="on">On</option><option value="off">Off</option></select></label><label><span>Dim</span><input type="range" id="splashDim" min="0" max="85" value="35"/></label><label><span>Blur</span><input type="range" id="splashBlur" min="0" max="10" value="0"/></label></div>
      
      <div class="group"><div class="groupTitle">AI (Preview)</div>
        <div class="toggle-row"><span>Show Orb</span><div class="toggle-switch" id="aiOrbToggle"></div></div>
        <label><span>State</span><select id="aiStateDemo"><option value="idle">Idle</option><option value="thinking">Thinking</option><option value="speaking">Speaking</option><option value="listening">Listening</option></select></label>
        <div class="toggle-row"><span>Voice React</span><div class="toggle-switch" id="voiceToggle"></div></div>
        <label><span>Size</span><input type="range" id="aiSize" min="30" max="90" value="60"/></label>
        <p class="mini">Drag to move. Use State menu to test.</p>
      </div>
      
      <div class="group"><div class="groupTitle">Developer</div><button class="btn secondary" id="exportSettings">Export</button><button class="btn secondary" id="importSettings">Import</button><button class="btn secondary" id="githubSave">GitHub (Stub)</button><p class="mini" id="registryStatus">Ready</p></div>
    </div>
  </aside>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
  <script src="main.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // --- FIX: SPLASH SCREEN ---
      const splash = document.getElementById('splashOverlay');
      if(splash) {
        const dismiss = () => {
           splash.classList.add('hidden');
           const v = document.getElementById('splashVideo');
           if(v) v.pause();
        };
        splash.addEventListener('click', dismiss);
        document.addEventListener('keydown', (e) => {
            if(e.key === 'Escape') dismiss();
        });
      }

      // 1. Toggle & Drag Logic
      const aiContainer = document.getElementById('aiContainer');
      const aiOrbToggle = document.getElementById('aiOrbToggle');
      const aiStateDemo = document.getElementById('aiStateDemo');
      const aiSize = document.getElementById('aiSize');
      
      // Canvas Resize Function
      const canvas = document.getElementById('aiOrbCanvas');
      const ctx = canvas.getContext('2d');
      let isAnimating = false;
      let angleX = 0;
      let angleY = 0;
      let audioVolume = 0;
      let simulationMode = 'idle';
      let sphereRadius = 60; // Default tuned to match slider

      function resizeCanvas() {
        if (!canvas) return;
        const rect = canvas.parentElement.getBoundingClientRect(); 
        if(rect.width > 0 && rect.height > 0) {
            canvas.width = rect.width * 2;
            canvas.height = rect.height * 2;
            ctx.scale(2, 2);
        }
      }
      resizeCanvas();
      
      // Handle Size Slider - Scales the internal sphere radius
      if(aiSize) {
          aiSize.addEventListener('input', (e) => {
              sphereRadius = parseInt(e.target.value);
          });
      }

      if(aiOrbToggle && aiContainer) {
        const newToggle = aiOrbToggle.cloneNode(true);
        aiOrbToggle.parentNode.replaceChild(newToggle, aiOrbToggle);
        
        newToggle.addEventListener('click', () => {
          newToggle.classList.toggle('active');
          const isOn = newToggle.classList.contains('active');
          if (isOn) {
            aiContainer.classList.add('visible');
            requestAnimationFrame(() => {
                resizeCanvas();
                if(!isAnimating) startOrbAnimation(); 
            });
          } else {
            aiContainer.classList.remove('visible');
          }
        });
      }

      // --- DRAG & DROP ---
      let isDragging = false;
      let dragOffsetX = 0;
      let dragOffsetY = 0;

      aiContainer.addEventListener('mousedown', (e) => {
          isDragging = true;
          const rect = aiContainer.getBoundingClientRect();
          dragOffsetX = e.clientX - rect.left;
          dragOffsetY = e.clientY - rect.top;
          aiContainer.style.cursor = 'grabbing';
      });

      document.addEventListener('mousemove', (e) => {
          if(!isDragging) return;
          e.preventDefault();
          let newLeft = e.clientX - dragOffsetX;
          let newTop = e.clientY - dragOffsetY;
          
          aiContainer.style.left = newLeft + 'px';
          aiContainer.style.top = newTop + 'px';
          aiContainer.style.bottom = 'auto'; 
          aiContainer.style.transform = 'none';
      });

      document.addEventListener('mouseup', () => {
          if(isDragging) {
              isDragging = false;
              aiContainer.style.cursor = 'grab';
          }
      });

      // --- 3D PARTICLE LOGIC (ORIGINAL + TUNED) ---
      const particles = [];
      const trailLength = 15;
      const particleCount = 45; 
      
      for(let i=0; i<particleCount; i++) {
          const theta = Math.acos(2 * Math.random() - 1);
          const phi = 2 * Math.PI * Math.random();
          // Normalized unit sphere
          particles.push({
              vx: Math.sin(theta) * Math.cos(phi),
              vy: Math.sin(theta) * Math.sin(phi),
              vz: Math.cos(theta),
              history: []
          });
      }

      function startOrbAnimation() {
        isAnimating = true;
        animate();
      }

      function project(x, y, z, cx, cy) {
          const scale = 200 / (200 + z);
          return { x: cx + x * scale, y: cy + y * scale };
      }

      function animate() {
        if (!isAnimating) return;
        requestAnimationFrame(animate);
        
        const width = canvas.width / 2;
        const height = canvas.height / 2;
        const cx = width / 2;
        const cy = height / 2;
        
        ctx.clearRect(0, 0, width, height);
        
        // Sim Logic
        let speed = 0.008; // Slower idle
        let scalePulse = 1;
        
        // STATE LOGIC
        if(simulationMode === 'thinking') {
            speed = 0.2; // Hyper fast spinning (Restored)
        } else if(simulationMode === 'speaking') {
            speed = 0.03 + (audioVolume * 0.05);
            scalePulse = 1 + (audioVolume * 0.5);
        } else if(simulationMode === 'listening') {
            speed = 0.005;
            scalePulse = 1.1;
        }

        // Colors
        const style = getComputedStyle(document.body);
        const c1 = style.getPropertyValue('--lg-accent').trim() || '#3b82f6';
        const c2 = style.getPropertyValue('--lg-accent2').trim() || '#6366f1';
        const c3 = style.getPropertyValue('--lg-accent3').trim() || '#ec4899';
        const colors = [c1, c2, c3];

        angleY += speed;
        angleX += speed * 0.5;

        const sinX = Math.sin(angleX);
        const cosX = Math.cos(angleX);
        const sinY = Math.sin(angleY);
        const cosY = Math.cos(angleY);

        ctx.globalCompositeOperation = 'lighter'; // Native Neon Glow

        particles.forEach((p, index) => {
            // Apply scale from slider to normalized vector
            let x = p.vx * sphereRadius;
            let y = p.vy * sphereRadius;
            let z = p.vz * sphereRadius;

            // Rotation
            let x1 = x * cosY - z * sinY;
            let z1 = z * cosY + x * sinY;
            x = x1; z = z1;

            let y1 = y * cosX - z * sinX;
            let z1_2 = z * cosX + y * sinX;
            y = y1; z = z1_2;

            // Scale Pulse (Voice)
            x *= scalePulse; y *= scalePulse; z *= scalePulse;

            p.history.push({x, y, z});
            if(p.history.length > trailLength) p.history.shift();

            if(p.history.length > 2) {
                const col = colors[index % 3]; 
                
                ctx.beginPath();
                ctx.strokeStyle = col;
                ctx.lineWidth = 1.5;
                // Standard glow removed to prevent performance issues
                // Lighter composite op provides enough effect
                
                let start = project(p.history[0].x, p.history[0].y, p.history[0].z, cx, cy);
                ctx.moveTo(start.x, start.y);
                for(let i=1; i<p.history.length; i++) {
                    let pos = project(p.history[i].x, p.history[i].y, p.history[i].z, cx, cy);
                    // Fade tail
                    ctx.globalAlpha = i / p.history.length;
                    ctx.lineTo(pos.x, pos.y);
                }
                ctx.stroke();
            }
        });
        ctx.globalCompositeOperation = 'source-over';
        ctx.globalAlpha = 1.0;
      }

      // 3. Audio & State Handling
      const voiceToggle = document.getElementById('voiceToggle');
      let audioCtx, analyser, dataArray;
      let listening = false;

      // Handle State Dropdown
      if(aiStateDemo) {
          const newDropdown = aiStateDemo.cloneNode(true);
          aiStateDemo.parentNode.replaceChild(newDropdown, aiStateDemo);
          newDropdown.addEventListener('change', (e) => {
              simulationMode = e.target.value;
              if(!aiContainer.classList.contains('visible')) document.getElementById('aiOrbToggle').click();
          });
      }

      if(voiceToggle) {
        const newVoiceToggle = voiceToggle.cloneNode(true);
        voiceToggle.parentNode.replaceChild(newVoiceToggle, voiceToggle);

        newVoiceToggle.addEventListener('click', async () => {
            newVoiceToggle.classList.toggle('active');
            listening = newVoiceToggle.classList.contains('active');

            if (listening) {
                simulationMode = 'speaking';
                if(!aiContainer.classList.contains('visible')) document.getElementById('aiOrbToggle').click();
                
                try {
                    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    const source = audioCtx.createMediaStreamSource(stream);
                    analyser = audioCtx.createAnalyser();
                    analyser.fftSize = 256;
                    source.connect(analyser);
                    dataArray = new Uint8Array(analyser.frequencyBinCount);
                    processAudio();
                } catch (err) {
                    console.error("Mic denied:", err);
                    alert("Mic access denied.");
                    newVoiceToggle.classList.remove('active');
                    listening = false;
                }
            } else {
                audioVolume = 0;
            }
        });
      }

      function processAudio() {
        if (!listening) return;
        requestAnimationFrame(processAudio);
        analyser.getByteFrequencyData(dataArray);
        
        let sum = 0;
        for(let i=0; i<dataArray.length/2; i++) sum += dataArray[i];
        const average = sum / (dataArray.length/2);
        
        const targetVol = average / 80; 
        audioVolume += (targetVol - audioVolume) * 0.1; 
      }
      
      startOrbAnimation();
      
      // 4. Re-bind Appearance Inputs (with Accent 3)
       const inputs = [
        { id: 'mutedColor', var: '--lg-muted' },
        { id: 'strokeColor', var: '--lg-stroke' },
        { id: 'surfaceColor', var: '--lg-surface' },
        { id: 'accent3Color', var: '--lg-accent3' }, // New Binding
        { id: 'glowStrength', var: '--lg-glow', transform: v => v / 100 }
      ];
      inputs.forEach(({ id, var: cssVar, transform }) => {
        const el = document.getElementById(id);
        if (el) {
          el.addEventListener('input', (e) => {
            const val = transform ? transform(e.target.value) : e.target.value;
            document.documentElement.style.setProperty(cssVar, val);
          });
        }
      });
    });
  </script>
</body>
</html>
'@

Set-Content -Path "I:\LionGateOS\start.html" -Value $Content -Encoding UTF8