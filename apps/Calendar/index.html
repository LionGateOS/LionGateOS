<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>LionGateOS Calendar — B30 Canonical Merge (True Glass + Full UX)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
:root{
  /* Background profiles (no warm red cast) */
  --bg-neutral:
    radial-gradient(1200px 800px at 20% 12%, rgba(120,90,255,0.18), transparent 60%),
    radial-gradient(1000px 720px at 80% 26%, rgba(140,180,255,0.12), transparent 65%),
    linear-gradient(180deg, #04050b, #020309);

  --bg-dark:
    radial-gradient(1100px 750px at 30% 18%, rgba(90,110,255,0.10), transparent 62%),
    linear-gradient(180deg, #02030a, #000);

  --bg-soft:
    radial-gradient(1000px 700px at 50% 18%, rgba(170,150,255,0.16), transparent 60%),
    radial-gradient(900px 650px at 80% 30%, rgba(120,170,255,0.10), transparent 65%),
    linear-gradient(180deg, #060713, #02030a);

  /* Glass + borders */
  --shell-bg: rgba(255,255,255,0.022);
  --header-bg: rgba(255,255,255,0.018);
  --card-bg: rgba(255,255,255,0.030);
  --card-bg-hover: rgba(255,255,255,0.048);

  --border: rgba(255,255,255,0.18);
  --border-strong: rgba(255,255,255,0.26);
  --border-hover: rgba(140,180,255,0.55);

  /* Text */
  --text: rgba(255,255,255,0.94);
  --muted: rgba(255,255,255,0.60);

  /* Accents */
  --accent: rgba(140,180,255,0.95);
  --glow: rgba(140,180,255,0.38);

  /* Layout */
  --radius: 22px;
  --cell-radius: 14px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; margin:0; }
body{
  font-family: system-ui, -apple-system, Segoe UI, sans-serif;
  color: var(--text);
  background: var(--bg-neutral);
  overflow:hidden;
}

/* Layer 0: particles live here (true background) */
#particle-layer{
  position:fixed;
  inset:0;
  z-index:0;
  pointer-events:none;
}

/* Layer 2: app */
#app{
  position:relative;
  z-index:2;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: clamp(10px, 2vw, 26px);
}

/* Shell is true glass (samples particles behind it) */
.shell{
  width:min(1120px, 100%);
  height:100%;
  display:flex;
  flex-direction:column;
  background: var(--shell-bg);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  backdrop-filter: blur(28px) saturate(145%);
  -webkit-backdrop-filter: blur(28px) saturate(145%);
  box-shadow: 0 40px 130px rgba(0,0,0,0.62);
}

/* Header */
.header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;
  padding: 14px 18px;
  background: var(--header-bg);
  border-bottom: 1px solid var(--border);
  border-top-left-radius: var(--radius);
  border-top-right-radius: var(--radius);
  backdrop-filter: blur(18px) saturate(140%);
  -webkit-backdrop-filter: blur(18px) saturate(140%);
}

.header h1{
  margin:0;
  font-size: 18px;
  font-weight: 750;
  letter-spacing: 0.2px;
}

.controls{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap: wrap;
  justify-content:flex-end;
}

.pill, .controls button, .controls select{
  background: rgba(255,255,255,0.045);
  border: 1px solid var(--border);
  color: var(--text);
  border-radius: 999px;
  padding: 6px 12px;
  cursor:pointer;
  transition: background .15s ease, border-color .15s ease, transform .15s ease;
  font-size: 13px;
}

.controls select{
  padding-right: 28px;
}

.controls button:hover, .controls select:hover{
  background: rgba(255,255,255,0.085);
  border-color: var(--border-strong);
}

.controls button:active{
  transform: translateY(1px);
}

/* Calendar */
.calendar{
  flex:1 1 auto;
  display:flex;
  flex-direction:column;
  padding: 12px;
  gap: 6px;
  min-height:0;
}

.weekdays{
  display:grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 6px;
  user-select:none;
}

.weekday{
  text-align:center;
  font-size: 12px;
  color: var(--muted);
  opacity: 0.95;
}

/* Grid */
.grid{
  flex:1 1 auto;
  display:grid;
  grid-template-columns: repeat(7, 1fr);
  grid-template-rows: repeat(6, 1fr);
  gap: 6px;
  min-height:0;
}

.day{
  background: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: var(--cell-radius);
  padding: 8px 8px 6px;
  display:flex;
  flex-direction:column;
  gap: 6px;
  transition: background .15s ease, border-color .15s ease, box-shadow .15s ease, transform .15s ease;
  will-change: transform, box-shadow, background;
}

.day.interactive:hover{
  background: var(--card-bg-hover);
  border-color: var(--border-hover);
  box-shadow:
    0 0 0 1px rgba(140,180,255,0.45) inset,
    0 0 16px var(--glow);
  transform: translateY(-1px);
}

.day.interactive:active{
  transform: translateY(0px);
}

.day.outside{
  opacity: 0.32;
  background: rgba(255,255,255,0.018);
  border-color: rgba(255,255,255,0.10);
}

.day.outside:hover{
  box-shadow:none;
  transform:none;
  border-color: rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.018);
}

.day.today{
  box-shadow: 0 0 0 1px var(--accent) inset;
}

.day-number{
  display:flex;
  align-items:center;
  justify-content:space-between;
  font-weight: 800;
  font-size: 13px;
}

.badge{
  font-size: 11px;
  color: rgba(255,255,255,0.70);
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.04);
  padding: 2px 8px;
  border-radius: 999px;
}

/* Placeholder event line (future) */
.event-placeholder{
  font-size: 11px;
  color: rgba(255,255,255,0.55);
  padding: 6px 8px;
  border: 1px dashed rgba(255,255,255,0.14);
  border-radius: 10px;
  background: rgba(0,0,0,0.10);
  min-height: 28px;
}

/* Responsive safety */
@media (max-width: 900px){
  .shell{ height: 100%; }
}
@media (max-width: 560px){
  .controls{ gap:6px; }
  .pill, .controls button, .controls select{ padding: 6px 10px; }
  .day{ padding: 7px; }
  .event-placeholder{ display:none; }
}
</style>
</head>

<body>
  <div id="particle-layer"></div>

  <div id="app">
    <div class="shell">
      <div class="header">
        <h1 id="monthLabel">—</h1>
        <div class="controls">
          <select id="bgSelect">
            <option value="neutral">Neutral</option>
            <option value="dark">Dark</option>
            <option value="soft">Soft</option>
          </select>
          <button id="prevBtn">◀</button>
          <button id="todayBtn">Today</button>
          <button id="nextBtn">▶</button>
        </div>
      </div>

      <div class="calendar">
        <div class="weekdays">
          <div class="weekday">Sun</div><div class="weekday">Mon</div><div class="weekday">Tue</div>
          <div class="weekday">Wed</div><div class="weekday">Thu</div><div class="weekday">Fri</div>
          <div class="weekday">Sat</div>
        </div>
        <div class="grid" id="calendarGrid"></div>
      </div>
    </div>
  </div>

  <script src="./assets/js/lion_gate_os_particle_module.js"></script>
  <script>
    let particleInstance = null;

    function initParticles(){
      if (typeof ParticleLayer === "function") {
        particleInstance = new ParticleLayer(
          document.getElementById("particle-layer"),
          160,
          false
        );
      }
    }

    function resizeParticles(){
      if (particleInstance && typeof particleInstance.resize === "function") {
        particleInstance.resize();
      }
    }

    window.addEventListener("resize", resizeParticles);
    window.addEventListener("orientationchange", resizeParticles);
    window.addEventListener("visibilitychange", () => {
      if (!document.hidden) resizeParticles();
    });

    window.addEventListener("load", () => {
      initParticles();
      resizeParticles();
    });
  </script>

  <script>
    const bgSelect = document.getElementById("bgSelect");
    const grid = document.getElementById("calendarGrid");
    const label = document.getElementById("monthLabel");
    let viewDate = new Date();

    function applyBackground(mode){
      if (mode === "dark") document.body.style.background = "var(--bg-dark)";
      else if (mode === "soft") document.body.style.background = "var(--bg-soft)";
      else document.body.style.background = "var(--bg-neutral)";
    }

    bgSelect.addEventListener("change", () => applyBackground(bgSelect.value));
    applyBackground(bgSelect.value);

    function isToday(d){
      const t = new Date();
      return d.getFullYear() === t.getFullYear() &&
             d.getMonth() === t.getMonth() &&
             d.getDate() === t.getDate();
    }

    function renderCalendar(){
      grid.innerHTML = "";
      const year = viewDate.getFullYear();
      const month = viewDate.getMonth();
      label.textContent = viewDate.toLocaleString(undefined, { month: "long", year: "numeric" });

      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const daysPrevMonth = new Date(year, month, 0).getDate();

      for (let i = 0; i < 42; i++){
        const cell = document.createElement("div");
        cell.className = "day";

        let dayNum, cellDate, isOutside = false;

        if (i < firstDay){
          dayNum = daysPrevMonth - firstDay + i + 1;
          cellDate = new Date(year, month - 1, dayNum);
          isOutside = true;
        } else if (i >= firstDay + daysInMonth){
          dayNum = i - (firstDay + daysInMonth) + 1;
          cellDate = new Date(year, month + 1, dayNum);
          isOutside = true;
        } else {
          dayNum = i - firstDay + 1;
          cellDate = new Date(year, month, dayNum);
        }

        if (isOutside) cell.classList.add("outside");
        else cell.classList.add("interactive");
        if (isToday(cellDate)) cell.classList.add("today");

        cell.innerHTML = `
          <div class="day-number">
            <span>${dayNum}</span>
            ${isToday(cellDate) && !isOutside ? `<span class="badge">Today</span>` : ``}
          </div>
          ${isOutside ? "" : `<div class="event-placeholder">Event placeholder</div>`}
        `;

        grid.appendChild(cell);
      }
    }

    document.getElementById("prevBtn").onclick = () => {
      viewDate.setMonth(viewDate.getMonth() - 1);
      renderCalendar();
    };
    document.getElementById("nextBtn").onclick = () => {
      viewDate.setMonth(viewDate.getMonth() + 1);
      renderCalendar();
    };
    document.getElementById("todayBtn").onclick = () => {
      viewDate = new Date();
      renderCalendar();
    };

    renderCalendar();
  </script>
</body>
</html>
